## 모바일 게임 환경에서의 터치 좌표 분석을 통한 매크로 탐지 기법 연구

A Study on the Macro Detection using the Analysis of Touch Coordinate in Mobile Game Environment 2023년 11월 07일

## 초록

매크로 또는 게임 봇은 게임 내의 재화 수집을 목적으로 사람의 개입 없이 플레이하는 자동 컴퓨터 프로그램이다. 온라인 게임에서의 자동사냥 게임 봇같이 비정상적인 재화수집은 게임 내 시장경제에 영향을 끼쳐 다른 사용자들에게 부정적인 영향을 끼칠 수 있으며, 또한 정직한 사용자로 하여금 상대적 박탈감을 주어 흥미를 잃게 돼 게임을 떠나 게임 수명을 단축시키는 결과를 초래한다.[1]  게임 시장 발전을 위해 매크로는 단절되어야 하며 이를 방지하기 위한 기술적 토대와 자원이 필요하다. 모바일 게임의 매크로는 안드로이드 어플리케이션과 윈도우에서 작동하는 응용 프로그램 등 다양한 형태로 제공된다. 또한 모바일 환경에서는 네트워크 제약 등의 이유로 PC 게임의 서버단의 탐지 기법을 모든 게임에 적용시키기에는 무리가 있다. 모바일에서의 터치 이벤트는 게임을 진행하기 위한 필수 요소로, 어떠한 동작을 위해서는 동작 버튼의 터치 영역을 클릭해야 한다. 이때 좌표를 남기게 되는데, 일반적인 매크로는 어떠한 로직에 의해 터치 좌표를 클릭하며, 정상적인 사용자와 다르게 나타나는 패턴을 분석해 매크로를 탐지하는 것이 가능하다. 최근 커뮤니티에서 유행하는 방식의 매크로는 터치 이벤트를 발동할 때 랜덤 좌푯값을 설정해 탐지를 우회한다. 본 논문에서는 해당 방식의 매크로를 터치 좌표 정보의 편차 분석을 통한 탐지 기법을 제안한다. 제안하는 방법은 최근 플레이가 활발하게 진행되는 모바일 게임들에게 적용해 오탐 없는 구별이 가능함을 보였다.		
	
키워드: 매크로, 봇, 모바일, 터치 이벤트
ABSTRACT

Macro or Game bot is an automatic computer program that plays without human intervention for the purpose of collecting goods in the game. Unusual goods collection, such as automatic hunting game bots in online games, can affect the market economy in the game and negatively affect other users, and can cause relative deprivation to honest users, resulting in losing interest and shortening game life. [1] Macros must be cut off for the development of the game market, and technical foundations and resources are needed to prevent them. In addition, in mobile environments, it is difficult to apply PC game server detection techniques to all games due to network restrictions. Mobile touch events are essential to the progress of the game, and you need to click on the touch area of the action button. At this point, coordinates are left, but a typical macro can detect a macro by clicking on the touch coordinates by some logic and analyzing patterns different from normal users. Macros that are popular in the community these days bypass detection by setting random coordinate values when triggering touch events. In this paper, we propose a method of detecting macros by analyzing touch coordinate information. The proposed method was applied to mobile games that have recently been actively played, indicating that it is possible to distinguish them without false possibility.

Keywords: Macros, Bots, Mobile, Touch event 

**초 록**

매크로 또는 게임 봇은 게임 내의 재화 수집을 목적으로 사람의 개입 없이 플레이하는 자동 컴퓨터 프로그램이다. 온라인 게임에서의 자동사냥 게임 봇같이 비정상적인 재화수집은 게임 내 시장경제에 영향을 끼쳐 다른 사용자들에게 부정적인 영향을 끼칠 수 있으며, 또한 정직한 사용자로 하여금 상대적 박탈감을 주어 흥미를 잃게 돼 게임을 떠나 게임 수명을 단축시키는 결과를 초래한다.\[1\] 게임 시장 발전을 위해 매크로는 단절되어야 하며 이를 방지하기 위한 기술적 토대와 자원이 필요하다. 모바일 게임의 매크로는 안드로이드 어플리케이션과 윈도우에서 작동하는 응용 프로그램 등 다양한 형태로 제공된다. 또한 모바일 환경에서는 네트워크 제약 등의 이유로 PC 게임의 서버단의 탐지 기법을 모든 게임에 적용시키기에는 무리가 있다. 모바일에서의 터치 이벤트는 게임을 진행하기 위한 필수 요소로, 어떠한 동작을 위해서는 동작 버튼의 터치 영역을 클릭해야 한다. 이때 좌표를 남기게 되는데, 일반적인 매크로는 어떠한 로직에 의해 터치 좌표를 클릭하며, 정상적인 사용자와 다르게 나타나는 패턴을 분석해 매크로를 탐지하는 것이 가능하다. 최근 커뮤니티에서 유행하는 방식의 매크로는 터치 이벤트를 발동할 때 랜덤 좌푯값을 설정해 탐지를 우회한다. 본 논문에서는 해당 방식의 매크로를 터치 좌표 정보의 편차 분석을 통한 탐지 기법을 제안한다. 제안하는 방법은 최근 플레이가 활발하게 진행되는 모바일 게임들에게 적용해 오탐 없는 구별이 가능함을 보였다.

키워드: 매크로, 봇, 모바일, 터치 이벤트

**ABSTRACT**

Macro or Game bot is an automatic computer program that plays without human intervention for the purpose of collecting goods in the game. Unusual goods collection, such as automatic hunting game bots in online games, can affect the market economy in the game and negatively affect other users, and can cause relative deprivation to honest users, resulting in losing interest and shortening game life. \[1\] Macros must be cut off for the development of the game market, and technical foundations and resources are needed to prevent them. In addition, in mobile environments, it is difficult to apply PC game server detection techniques to all games due to network restrictions. Mobile touch events are essential to the progress of the game, and you need to click on the touch area of the action button. At this point, coordinates are left, but a typical macro can detect a macro by clicking on the touch coordinates by some logic and analyzing patterns different from normal users. Macros that are popular in the community these days bypass detection by setting random coordinate values when triggering touch events. In this paper, we propose a method of detecting macros by analyzing touch coordinate information. The proposed method was applied to mobile games that have recently been actively played, indicating that it is possible to distinguish them without false possibility.

Keywords: Macros, Bots, Mobile, Touch event

**차 례**

[제 1 장 서 론 - 1 -](#_Toc151666581)

[제 2 장 관련 연구 - 3 -](#_Toc151666582)

[제 3 장 배경 지식 - 6 -](#_Toc151666583)

[3.1 모바일 게임 - 6 -](#_Toc151666584)

[3.2 앱플레이어 - 6 -](#_Toc151666585)

[3.2 매크로 - 7 -](#_Toc151666586)

[3.3 안드로이드 터치 이벤트 - 8 -](#_Toc151666587)

[3.4 데이터 클러스터링 알고리즘 - 9 -](#_Toc151666588)

[3.4.1 DBSCAN 알고리즘 - 10 -](#_Toc151666589)

[제 4 장 탐지 과정 - 12 -](#_Toc151666590)

[4.1 버튼 터치 영역 설정 - 14 -](#_Toc151666591)

[4.2 분석 알고리즘 - 19 -](#_Toc151666592)

[4.2.1 상대적 분포비율 (Relative Spread) - 19 -](#_Toc151666593)

[4.3 분석 과정 - 20 -](#_Toc151666594)

[제 5 장 실험 결과 및 결론 - 21 -](#_Toc151666595)

[5.1 실험결과 - 21 -](#_Toc151666596)

[5.2 결론 - 22 -](#_Toc151666597)

[5.3 향후 연구 - 23 -](#_Toc151666598)

[참 고 문 헌 - 24 -](#_Toc151666599)

[감 사 의 글 - 26 -](#_Toc151666600)

**그 림 차 례**

[\[그림 1\] getevent 리스트 출력 화면 - 8 -](#_Toc151666602)

[\[그림 2\] K-평균 클러스터링으로 분류된 군집\[13\] - 9 -](#_Toc151666603)

[\[그림 3\] epsilon\[14\] - 10 -](#_Toc151666604)

[\[그림 4\] num points에 따라 군집으로 인정한 경우\[14\] - 11 -](#_Toc151666605)

[\[그림 5\] num points에 따라 군집으로 인정받지 못한 경우\[14\] - 11 -](#_Toc151666606)

[\[그림 6\] 단순한 매크로의 터치 영역 - 12 -](#_Toc151666607)

[\[그림 7\] 랜덤 좌표 로직을 적용한 복잡한 매크로의 터치 영역 - 13 -](#_Toc151666608)

[\[그림 8\] 정상적인 사용자의 터치 영역 - 13 -](#_Toc151666609)

[\[그림 9\] 1분간 수집한 좌표 (매크로) - 14 -](#_Toc151666610)

[\[그림 10\] DBSCAN 분류 결과 (매크로) - 15 -](#_Toc151666611)

[\[그림 11\] 최적 영역 설정 (매크로) - 15 -](#_Toc151666612)

[\[그림 12\] 통합된 최적 영역의 좌표들 - 16 -](#_Toc151666613)

[\[그림 13\] 사람의 경우 터치 좌표 수집 - 17 -](#_Toc151666614)

[\[그림 14\] 사람의 경우 클러스터링 결과 - 17 -](#_Toc151666615)

[\[그림 15\] 사람의 경우 최적 영역 설정 - 18 -](#_Toc151666616)

[\[그림 16\] 사람의 경우 도출된 최적 영역 좌표들 - 18 -](#_Toc151666617)

[\[그림 17\] 매크로 탐지 시퀀스 다이어그램 - 20 -](#_Toc151666618)

[\[그림 18\] 매크로와 사람의 분포 결과 - 21 -](#_Toc151666619)

# **제 1 장 서 론**

21세기 인터넷 발달과 함께 게임 산업은 발전해왔다. 특히 게임시장의 주류 플랫폼으로 올라섰다. 2023년 전 세계 모바일 게임 시장 규모가 약 1080억 달러(약 144조원)로 전체 게임 시장의 절반 이상을 차지할 것이라는 분석이 나왔다. 이는 PC 게임 시장의 2.7배, 콘솔 게임 시장의 2.6배가 될 전망이다.\[2\] 국내 게임 시장의 상황도 비슷하다. 올해 1분기 모바일 게임 시장 규모가 가장 큰 지역은 아시아,태평양 지역이었는데, 한국이 시장을 견인했다. 지난 1분기 한국의 모바일 게임 지출은 5억5000만 달러(약 2조원)로 지난해 1분기보다 15% 성장했다.\[2\] 이렇듯 앞으로도 발전 가능성이 다분한 분야이다.

이러한 게임의 성장과 함께 게임 산업의 회색지대로 게임 아이템을 현실의 재화를 통해 서로 사고 파는 현상도 나타났으며, 아이템 매니아 같은 게임 재화 거래 중계 업체들도 나타나는 실태이다. 게임 내 재화는 시장 경제에 따라 많은 가치를 가지기도 하며 보통 이를 얻기 위해서 많은 시간과 노력을 부어서 얻어야 하지만, 악의적인 사용자들은 매크로를 사용해 노력없이 재화를 수급하는 것이 가능하다. 또한 시간적 여유가 없는 사용자들은 회색 지대에서 현금을 지불하고 아이템을 사는 실정이다. 그로 인해 게임 내 재화를 전문적으로 판매하는 판매자들이 많은 상황이다. 즉, 매크로는 게임 내 재화를 노력없이 얻거나, 판매해 이득을 취할 수 있는 수단으로서 많은 수요를 가진다.

매크로는 아주 단순하지만 게임 시장에 큰 영향을 끼치며 사람의 개입 없이 자동으로 지정된 작업을 반복하며 게임 생태계를 유린한다. 이는 정상적으로 플레이 하는 사용자들과 형평성을 문제를 야기하고 공정성을 해칠 수 있다. 사용자의 이탈로 게임사가 피해를 볼 수 있는 만큼 매크로는 근절되어야 한다.

PC 온라인 게임과 다르게 모바일 게임의 환경 특성상 터치 입력이 대부분의 기능을 수행하는 만큼 비교적 매크로의 제작이 쉬운 편이라 할 수 있다. 검색 사이트와 커뮤니티를 찾아보면 손쉽게 누구나 정보에 접근할 수 있으며 이는 심각한 문제이다. 또한 앱플레이어의 등장으로 PC 환경에서 모바일 게임을 동작하는 것이 가능해졌다. 즉, 안드로이드 환경에서 동작하는 매크로 대신 Python과 Autohotkey 등 고성능 프로그래밍 언어로 매크로를 제작 및 사용이 가능해진 것이다.

최근 커뮤니티 상에서 위와 같은 프로그램으로 기존의 탐지를 우회하는 방식으로 매크로를 제작하는 방법을 쉽게 찾을 수 있으며, 이에 본 논문에서는 해당 방식의 매크로를 막을 수 있는 방법을 제안한다. 최근 모바일 매크로의 주요 방식은 사람과 매크로를 인지하지 못하게 특정 터치영역을 랜덤값을 넣어 영역 내 모든 좌표를 클릭하는 방향을 추구한다. 기존의 단순한 매크로는 한가지 좌푯값을 설정하고 클릭하기 때문에 기존 매크로 탐지에 걸릴 확률이 높다. 하지만 본 논문에서는 사용하는 상대 분포도 개념을 통해 매크로와 사람 간의 패턴을 인식하고 정확히 분류가 가능하다.

모바일 게임의 특성상 반복되는 행동을 하기 위해 특정 영역을 반복해서 입력할 경우가 많고, 특히 RPG 분야의 게임의 경우, 게임내 버튼이 표시되어 특정 터치 영역을 제시한다. 패턴을 분석하기 위해 입력된 터치 좌표가 일정 영역에 분포해 있어야 하는데, 앞선 이유로 영역 추출에 용이해 모바일 매크로 탐지에 본 방법이 유리하다 할 수 있다. 또한 적은 메모리를 사용해 모바일의 한정적인 자원을 생각해 볼 때 효과적인 방법이라 할 수 있다.

# **제 2 장 관련 연구**

김정현 등\[3\]은 안드로이드 환경 클라이언트 단에서 터치 이벤트의 중복 좌표와 발생 빈도 측정을 통해 매크로를 탐지하였다. 특정 기능을 수행하기 위해 하나의 좌표를 클릭하는 단순한 매크로에 대한 탐지 방법을 제시하였다. 실제 사용자는 여러 좌표를 터치하는 반면 해당 매크로의 방식은 하나의 좌표만을 터치해 좌표 중복률이 일정 수치를 넘어가고 exact pattern matching을 이용해 선별된 유저를 매크로로 분류하였다. 해당 방법을 통해 효과적으로 매크로 탐지가 가능하지만 특정 스테이지를 사람이 직접 설정해주어야 한다는 불편함이 있고, 최근 커뮤니티에서 공유되는 방식인 랜덤 좌표를 이용한 방식을 탐지하기엔 어려움이 있다. 장준언 등\[4\]은 클라이언트단에서 유사 블록을 사용한 자기 유사도 측정을 통해 적은 단위의 자원으로 높은 탐지력을 구현하였다. 유사도 측정을 위한 휴식 비율, 터치분포를 분석하였다. 한정된 모바일 환경의 터치 입력 정보만으로도 많은 정보를 단위화 할 수 있음을 알렸다. 또한 유사 블록 개념을 온라인 게임의 경우의 적용 가능성을 향후 연구로 계획했다. 정윤혁\[5\]은 터치 카운트 이용하거나 프로세스 네임을 통해 직접 탐지하는 기법을 제안했다. 위 논문들은 게임을 동작하는 클라이언트 단에서 탐지하는 기법을 제안하였으며 이는 기기의 적은 자원을 사용한다면 서버 단의 탐지 기법과 다르게 스케일을 줄일 수 있고, 서버를 사용하지 않아도 되는 장점이 있다.

최근 각종 티켓팅에서 매크로를 이용한 불법 암표상들 때문에 골머리를 앓고 있다. 이에 웹에서 사용되는 매크로를 탐지하는 논문들도 있는데, 김준영 등\[6\]은 웹서버에서 접속자의 정보를 보여주는 로그인 Access_log을 분석해 웹 매크로를 식별하였다. 사용자의 접속을 구분하기 위한 특성인자를 추출해 매크로와 사람의 패턴 차이를 비교하고 구별하였다.

서버 단의 로그 분석을 통한 논문들도 있는데, 강용구 등\[7\]은 플레이어 캐릭터의 특정 활동 로그를 기반으로 Action time interval을 추출해 게임 봇을 탐지하였다. 윤태복 등\[8\]은 온라인 게임에서 플레이어의 과거 게임 행위 정보와 봇을 이용한 게임 플레이 정보를 수집 분석해 게임 행위 변화 패턴 모델을 생성하는 방법을 제안했다. 이는 실험을 통해 실제 서비스 중인 온라인 게임에서 사용자와 봇의 모델을 생성하고 유사성을 판별해 적절한 결과를 확인하였다. 한종우 등\[9\]은 재화와 관계에 있는 로그 데이터를 사용해 저용량 데이터 처리를 통해 효율적으로 게임 봇을 탐지하는 기계학습 기반의 방법을 제안했다. 로그 중 5개의 특징만 추출해 적은 메모리 사용으로 타 논문 대비 높은 정확도 결과를 보여 효과적인 방법을 제시했다. 최준영 등\[10\]은 비정상적인 편취 행위를 하는 RPG 분야에서의 게임 봇 프로그램을 누적 로그 기반 머신러닝 학습을 이용하여 탐지하는 기법을 소개하였다. 데이터 시트의 분석 없이도 계측 값만 존재한다면 특정 행위를 반복하는 봇의 특징을 이용해 탐지하는 방법을 제안하고 검출이 가능함을 보여주었다. 작업장이란 게임 내에서 대규모로 게임 재화를 채굴하여 현금화하는 집단을 뜻한다. 하명성 등\[11\]은 Ensemble 기법을 통한 매크로 작업장 검출, 그래프 이미지 클러스터링을 통한 도감작 작업장 검출, 그리고 이동 패턴 분석을 통한 도감작 작업장ㄹ 검출의 세 가지 방법을 제시하였고, 이들의 결과를 교차 검증하여 보다 높은 신뢰도의 작업장 검출 방법을 제시하였다. 김주환 등\[12\]은 본 논문에서 사용한 클러스터링 기법을 서버단에서 사용하였다. 탐지 대상 기간을 하루 단위로 나누어 해당 일자에 대한 게임 봇 여부를 우선 판별하고, 이후 최종 결과를 판단하는 방법을 제시하였다. 일일 단위 로그에서 일반 유저와 게임 봇 유저를 잘 구분할 수 있는 로그를 지표로 선정해 클러스터 그룹을 형성하였다. 이후 분류기를 통해 결과를 추출하고 전체 기간에 대한 게임 봇을 추정하였다. 게임 전체 유저에 대한 탐지 방식으로 타 연구와 달리 범용적인 유의미한 결과를 보여주었다. 이와 같이 서버 단에서 동작하는 탐지 기법의 경우 과거의 데이터를 참고하거나 사용하는 것이 가능하고 여러 로그를 분석할 수 있어 아무래도 복잡한 PC 온라인 게임에서 매크로 탐지하는데 용이한 것으로 보인다. 그에 반해 모바일 환경에서는 네트워크 제약이 존재하는 상황이다. 또한 영세한 모바일 게임 회사의 경우 효과적인 서버 단 탐지기법이라 할지라도 비용 문제로 귀결될 수 있어 보인다.

본 연구에서 제안하는 기법은 클라이언트 단에서 동작이 가능하므로 서버 환경이 필수적이지 않다. 또한 최근 커뮤니티에서 제안하는 방식의 매크로를 효과적으로 검출할 수 있고, 터치 입력만으로 작동되기에 모바일 환경에서 바로 적용시킬 수 있는 장점이 있다.

# **제 3 장 배경 지식**

## **3.1 모바일 게임**

모바일 게임은 스마트폰, 태블릿PC 등 휴대용 기기를 통해 즐길 수 있는 비디오 게임의 일종이다. 현재 가장 많이 사용되는 모바일 운영체제로는 IOS와 안드로이드가 있는데, 본 연구에서는 안드로이드 환경에서 탐지 및 실험을 진행하였다. 모바일 게임은 PC 게임과 다르게 어디서든지 휴대용 기기를 이용해 쉬운 접근이 가능하며 보통의 경우 PC와 비교해 무선 환경으로서 네트워크 제약이 있다. 초창기 모바일 게임은 짧은 플레이 타임을 가져 킬링 타임 용으로 주로 제작이 되었으나 하드웨어의 발전에 따라 온라인 시장에서 유행하는 RPG, FPS 장르의 게임도 유입이 진행되었다. 이에 따라 게임내 재화와 시장 개념도 등장해 매크로도 함께 발전하게 되었다. 기능 수행을 위해 터치 입력이 전부라는 특징을 가지고 단순한 조작 방식을 채택하는 경우가 많아 매크로 제작이 비교적 쉬운 편이다.

## **3.2 앱플레이어**

하드웨어 사양의 발달과 함께 모바일 게임의 사양도 발달하였다. 앱플레이어는PC 환경에서 모바일 게임을 플레이하기 위한 장치로서 높은 사양의 게임을 돌리기에 유리하며, 더 많은 입력 장치로 인한 장점을 모바일에 적용이 가능하게 해준다. 또한 휴대기기 환경과 다르게 다양한 편의성 기능을 제공해 앱플레이어 이용자가 늘어나는 추세이다.

## **3.2 매크로**

매크로는 사용자의 단순하고 반복적인 동작을 프로그램이 대신 수행해주는 것으로서 힘을 덜어주는 본래 편리를 위한 프로그램이다. 하지만 이를 악용하는 이용자가 증가하며 매크로로 온라인 매표를 하거나 수강 신청, 선착순 이벤트 등 여타 악의적인 매크로를 제작하거나 배포, 판매하는 등 공정성이 위배되는 상황이다.

다시 모바일 게임의 매크로로 돌아와, 최근 앱플레이어의 등장으로 모바일 환경에서 작동하는 매크로보다 PC환경 매크로를 선호하는 추세이며, 본 연구에서는 PC 환경에서 제작되는 매크로를 중점으로 진행하였다. 주로 프로그래밍 언어인 파이썬(Python)과 오토핫키(Autohotkey) 등을 사용하여 제작되며 다른 언어들에 비해 제작 난이도가 쉽고 강력한 기능을 제공한다. 기본적인 기능으로는 마우스 클릭 및 키보드 입력, 조건 부 동작, 무한 반복, 이미지 인식 등이 있으며 해당 기능 들로 게임 내 반복적인 작업을 수행할 수 있도록 구현하는 것이 가능하다. 최근 커뮤니티에서 알려진 방식으로 기존 매크로 탐지 기법을 우회하기 위해 동작을 위한 게임 내 버튼을 이미지로 서칭 후 버튼 별 터치 영역을 설정하고 영역 내에 랜덤 좌푯값을 대입해 무작위로 터치 입력을 수행하게 하여, 사람과 구별이 쉽지 않도록 제작되고 있는 실정이다.

## **3.3 안드로이드 터치 이벤트**

안드로이드 환경에서 사용자가 터치 입력을 하면 발생하는 이벤트로 입력된 데이터 형식과 시간과 X, Y좌표를 정보로 담고 있다. 예를 들어 모바일 게임에서 A버튼을 클릭해 동작하기 위해서는 A버튼이 지정한 터치 영역에 접근해야 하는데 손으로 해당 지점을 터치하면 모바일 기기에서 터치 이벤트가 발생하고 어떠한 입력인지 정보를 판단하여 A버튼 터치 영역과 일치한다면 A버튼이 동작하는 원리이다. 본 연구에서는 일정 시간단위로 터치 이벤트 정보를 수집해야 하므로 안드로이드 ADB(Android Debug Bridge) 도구의 getevent 명령어를 사용하였다. \[그림 1\]은 명령어를 사용했을 때 수집할 수 있는 이벤트 리스트이다. 리스트 중에서 ABS_MT_TRACKING_ID 는 이벤트 ID를 의미하고, ABS_MT_POSITION_ X와 ABS_MT_POSITION_Y값이 각각 X, Y좌표를 의미한다.


\[그림 1\] getevent 리스트 출력 화면

## **3.4 데이터 클러스터링 알고리즘**

데이터를 분류하기 위한 알고리즘으로 비지도 학습 알고리즘 중 하나이다. 클러스터링이란, 서로 유사한 속성을 갖는 데이터를 같은 군집으로 묶어주는 작업을 의미한다. 또한 클러스터란 분류된 데이터, 군집, 집합 등의 같은 의미를 가진다. 클러스터링엔 계층적 클러스터링과 특정 기준에 따라 중심점을 선택해 군집으로 분류하는 분할적 클러스터링의 두 종류가 있는데, 여기서는 분할적 방법을 알아보겠다. 분할적 클러스터링에는 중심 기반과 밀도 기반의 두 방법으로 나눠진다 할 수 있다. 중심 기반의 경우, 분류된 데이터들은 특정 중심을 기준으로 분포되며, 그 중 대표적인 예로는 K-평균(K-Means) 클러스터링이 있겠다. K개의 대표 데이터를 선정하고 나머지 데이터들에 대해 K개의 데이터 중 가장 가까운 데이터를 탐색해 해당 집단에 속한다. 그렇게 클러스터들이 형성되면 데이터들의 평균을 구해 새로운 대표 데이터로 선정해 반복하여 최종 분류를 진행하게 된다. 본 논문에서 채택한 밀도 기반의 경우, 분류된 각 데이터들은 서로 근접하게 분포한다고 볼 수 있고, 대표적인 예로는 DBSCAN 클러스터링이 있겠다. 본 연구를 진행하기 위해 게임의 특정 터치 영역을 각각 군집으로 분류해야 하는데, K-평균 같은 방식은 영역의 개수를 추정하지 못하므로 사용하지 못한다.


\[그림 2\] K-평균 클러스터링으로 분류된 군집\[13\]

### **3.4.1 DBSCAN 알고리즘**

K-평균 알고리즘이 특정 중심을 기준으로 분류했다면, DBSCAN은 데이터의 밀도를 기반으로 서로 가까운 데이터들을 군집화해 클러스터를 형성하는 알고리즘이다. 또한 밀도가 다양하고 모양이 불규칙한 클러스터 등 모양이 잘 정의 되지 않은 데이터들을 처리할 때 유용한 방법이다. 즉 노이즈(이상치)가 큰 데이터 집단에 유리하다는 말이고 이는 모바일 환경에서 터치 좌표 집단에 적용할 때 유용할 것이다. 해당 환경에서는 게임, 스테이지 별로 사용하는 터치영역이 다를 수도 있고 정확한 수를 측정하거나 사전에 아는 것이 어렵다. 하지만, 특정 터치 영역을 반복해서 누르게 되는 특성 상 전체 터치 영역 중 밀도가 높은 곳이 생기기 마련이다. 그렇게 밀도가 많은 곳은 특정 터치 영역일 확률이 매우 높을 것이다.

따라서 DBSCAN을 이용해 같은 버튼 위치로 특정이 되는 터치 좌표들을 분류가 가능할 것이다. 파라미터 값으로는 epsilon(반경의 크기)와 min points(최소 군집 크기)있다. \[그림 3\]에서 보듯 epsilon은 같은 클러스터로 포함이 될 수 있는 원의 반지름 값으로 해당 반경 안의 데이터는 같은 클러스터로 정의해준다.


\[그림 3\] epsilon\[14\]

\[그림 4\]\[그림 5\]를 보면 min points 값을 기준으로 클러스터를 형성하는 것을 볼 수 있다.


\[그림 4\] num points에 따라 군집으로 인정한 경우\[14\]


\[그림 5\] num points에 따라 군집으로 인정받지 못한 경우\[14\]

# **제 4 장 탐지 과정**

모바일 게임의 진행은 PC의 입력 장치과 달리 터치패널에 손가락 혹은 도구 등을 이용한 사용자의 직접적인 터치 동작으로 이벤트를 발생시켜 이루어진다. 매크로의 입력은 사람과 동일한 입력의 형태로 들어오기에 단순 입력 데이터만으로는 구별할 수 없다. 게임 플레이 중 같은 스테이지 같은 동작을 하도록 실험하여 getevent로 터치 좌표를 10분간 수집해 비교해보았다. \[그림 6\]은 단순 자동 매크로로 같은 좌표를 연속해서 터치하므로 기본적인 매크로 탐지에 검출될 확률이 높다. \[그림 7\]은 최근 커뮤니티에서 구현하는 방식으로 랜덤 좌표를 설정해 기존 매크로 탐지를 회피한다. \[그림 8\]은 정상적인 사용자의 터치 영역이다. 이처럼 육안으로는 판단이 되는 듯 하지만 기존의 매크로 탐지에서는 \[그림 7\]과 \[그림 8\]을 구별할 수 없어 아래 방법을 제안한다.


\[그림 6\] 단순한 매크로의 터치 영역


\[그림 7\] 랜덤 좌표 로직을 적용한 복잡한 매크로의 터치 영역


\[그림 8\] 정상적인 사용자의 터치 영역

## **4.1 버튼 터치 영역 설정**

플레이어의 좌표를 일정시간 단위로 수집한다.\[그림 9\] 본 연구에서는 1분 단위로 수집하였다. 긴 시간을 단위로 수행하면 스테이지가 바뀌거나 일정 패턴을 벗어날 가능성이 있어 최소한의 특징을 분류할 수 있는 짧은 시간을 단위로 설정한다. 일정 시간 단위마다 수집하는 일련의 과정을 설명하겠다. 아래 그림들은 플레이어가 매크로인 경우이다. 수집한 좌표를 분류하기 위해 DBSCAN을 이용해 밀도를 기준으로 1차 분류한다.\[그림 10\] epsilon은 22, min points는 1로 각각 값을 설정하였다. 가장 많은 점을 가지고 있는 군집을 최적 영역으로 할당한다. 다른 터치 영역과 거리가 멀수록 특정한 버튼일 가능성이 있고, 가장 많은 점이 포함 되어 있다는 것은 주요 기능을 수행하는 버튼이 있을 터치영역일 가능성이 높다.\[그림 11\]


\[그림 9\] 1분간 수집한 좌표 (매크로)


\[그림 10\] DBSCAN 분류 결과 (매크로)


\[그림 11\] 최적 영역 설정 (매크로)

이렇게 일정 횟수를 반복하여 충분한 데이터가 쌓일 때까지 대기한다. 본 연구는 5회를 기준으로 진행하였다. 최적 영역으로 설정된 터치 영역을 비교해 같은 영역에 있다 판단되면 하나의 영역으로 통합한다.\[그림 12\] 판단 기준은 터치 좌표의 최외각에 직사각형 영역을 생성하고 대략 50% 기준으로 겹쳐 있으면 같은 영역으로 판단하였다. 이렇게 도출된 영역은 게임 내에서 하나의 버튼으로서 주요 기능을 담당하는 터치 영역으로 추정하였다. 플레이어가 사람인 경우에도 위와 같은 방식으로 진행하여 터치 영역을 도출하였다.\[그림 13\]\[그림 14\]\[그림 15\] \[그림 16\] 매크로와 사람의 최종 단계의 최적 영역을 살펴보았을 때, 매크로의 경우, 점들이 골고루 퍼져 있는 모습이다. 사람의 경우, 중앙이나 어느 한 부분으로 치우쳐 몰리는 모습을 볼 수 있다. 즉 매크로는 점의 평균값과 비교해 나머지 점들의 편차가 큰 편이고, 사람은 비교적 작은 편이라 할 수 있다.


\[그림 12\] 통합된 최적 영역의 좌표들


\[그림 13\] 사람의 경우 터치 좌표 수집


\[그림 14\] 사람의 경우 클러스터링 결과


\[그림 15\] 사람의 경우 최적 영역 설정


\[그림 16\] 사람의 경우 도출된 최적 영역 좌표들

## **4.2 분석 알고리즘**

### **4.2.1 상대적 분포비율 (Relative Spread)**

도출된 최적 영역을 분석하기 위한 기법으로 상대적 분포비율 식(1)을 사용하였다. 상대 분포 비율은 표준편차와 비슷한 원리인데 각 좌푯값의 평균과 좌푯값과의 거리를 제곱하여 더하고 제곱근을 씌우고 모든 점을 합한다. 이는 표준 편차와 분산처럼 평균값으로부터 각 값들이 멀리 분포할수록 값이 커진다고 볼 수 있다. 즉, 매크로의 경우\[그림 12\] 랜덤 좌푯값을 설정한 탓에 데이터가 일정 이상 쌓이면 편차가 커질 수밖에 없는 것이다. \[그림 16\]에서 사람의 터치 영역은 버튼의 중앙으로 쏠린다고 볼 수 있겠다. 그 탓에 분포비율 값 또한 비교적 작아지는 경향을 보였다. 상대적 개념은 분모에서 찾아볼 수 있는데, 해상도와 버튼 크기에 따라 터치영역의 넓이가 다를 수밖에 없어 영역의 대각선 길이를 구하고 점의 개수를 곱하여 일정 비율이 되도록 분모를 구성하였다. \[그림 12\]\[그림 16\]의 Relative Spread 값은 각각 약 0.26과 0.12이 도출되었다. 후에 나올 실험에서 보여줄 텐데 매크로를 여러 번 돌려본 결과 0.25 이상의 값들이 꾸준히 나오고, 사람은 0.15 이하의 값들이 나타났다. 이는 상대적 분포 비율이 매크로와 사람을 확실하게 탐지하는데 효과적인 식임을 말해준다.

## **4.3 분석 과정**

\[그림 17\]은 본 연구에서 제안하는 방법을 시퀀스 다이어그램으로 나타낸 것이다. Player에게 터치 정보를 수집, DBSCAN을 통한 터치영역 분류, Selector에서 최적 영역을 선정, Collector를 통해 하나의 최적영역으로 통합, 그 후 패턴을 분석해 Separator에서 분류해 탐지를 진행한다. 설명을 추가하자면, Player부터 Collector까지 일정 시간 단위로 계속해서 진행한다. 분류한 터치영역들이 다 도착하면 Collector는 종합해 도출한다. 마지막으로 분석과정으로 패턴을 상대적 분포 비율로 계산하고, 임곗값에 따라 Separator에서 탐지 결과값이 반환되는 과정이다.

\[그림 17\] 매크로 탐지 시퀀스 다이어그램

# **제 5 장 실험 결과 및 결론**

## **5.1 실험결과**

구글 플레이스토어에서 게임 매출 순위권에 포함된 “세븐나이츠 키우기(넷마블)”을 실험 대상으로 삼았다. 직접 파이썬으로 랜덤 좌표를 이용한 매크로를 제작하여 사용하고, 3명의 정상적인 플레이어와 비교해보았다. 파이썬의 Pyautogui 패키지를 사용해 구현하였다. 매크로와 플레이어는 같은 목표를 두고 같은 동작을 반복해서 시행하였다. 같은 스테이지에서 1분 단위로 터치 좌표를 5회 수집하였다. 이와 같은 방법으로 5회 이상 시행하였고 터치 좌표에 대한 매크로와 사람의 상대적 분포 결과를 얻을 수 있었다.\[그림 18\] 매크로의 경우 약 평균 0.285, 최대 0.297 ,최소 0.255의 값들이 나타났고, 사람의 경우 약 평균 0.178, 최대 0.200, 최소 0.120의 값들이 나타났다. 분포 결과를 보면 매크로와 사람의 그래프가 겹치는 부분이 없이 완벽하게 두 집단으로 나눠진 걸 볼 수 있겠다. 즉 매크로와 사람을 탐지하는 게 가능하였다.

\[그림 18\] 매크로와 사람의 분포 결과

## **5.2 결론**

본 논문에서는 상대적 분포 비율을 이용한 패턴 분석으로 모바일 환경에서 랜덤 좌푯값을 설정해 작동하는 매크로 탐지 방법을 제안하였다. 매크로와 사람을 구분하기 위해 좌표 데이터들의 밀도를 구해야했고, 이에 상대적 분포 비율 개념을 제안해였다. 상대적 분포 비율은 표준 편차와 같은 원리를 가지고, 각기 다른 해상도와 범위를 가진 좌표 데이터 집단도 비교할 수 있는 개념이다. 이에 필요한 데이터 집단을 얻기 위해 모바일 기기로부터 실시간 좌표 데이터를 수집하고 DBSCAN을 이용해 데이터를 분류하였다. 위 개념들을 바탕으로 본 논문에서는 분류된 데이터의 패턴을 분석하기 위해 상대적 분포 비율을 측정하였고, 한 개의 게임에서 총 15개의 실험 데이터를 통해 특정 방식의 매크로와 사람을 100% 구별하였다.

또한, 짧은 시간 수집하여 데이터를 처리하고 결과를 내고 데이터는 버리기 때문에 적은 메모리 공간을 사용해 자원을 효율적으로 사용할 수 있다. 따라서 클라이언트 단에서도 동작할 수 있는 탐지 기법으로 모바일 기기 환경에 적절한 방법이라고 할 수 있다.

## **5.3 향후 연구**

본 연구에서는 특정 방식의 매크로를 탐지하기 위한 원리를 소개하였다. 해당 방식에 대해 오탐없는 탐지를 구현하였으나, 이는 여러 다른 방식에 대해선 한계가 있다. 예를 들어 매크로의 터치 동작 로직을 랜덤 좌푯값이 아닌 정규 분포를 이용해 터치 영역을 구성한다면, 사람과 비슷하고 정확히 중앙에 점이 몰릴 것이다. 하지만 현재 이 방식을 소개하는 국내 블로그나 유튜브는 없는 것으로 사료된다. 또한, 특정 방식의 매크로를 탐지하므로 어떤 게임이든 탐지 과정이 비슷해 1개의 게임에 대한 매크로만 가지고 실험을 진행하였다. 하지만 더 다양한 장르의 게임에 대한 매크로들의 경우에도 추가적인 실험이 필요해 보인다. 향후, 본 연구의 방식과 기존 매크로 탐지 방식을 함께 적용해 구성하거나 앞서 말한 정규 분포 방식에 있어 막을 수 있는지에 대한 연구가 필요하다.

# **참 고 문 헌**

\[1\] Ah Reum Kang, Jiyoung Woo, Juyong Park, Huy Kang Kim, “User Behavior Analysis for Online Game Bot Detection,” Jonornal of The Korea Institute of information Security & Cryptology, 22(2), pp. 225-238, Apr. 2012

\[2\] 머니투데이 “올해 글로벌 모바일 게임시장 144조 규모 전망…PC게임의 약2.7배” <https://news.mt.co.kr/mtview.php?no=2023090611451957002>

\[3\] Jeong-hyeon Kim,† Sang-jin Lee‡ Center for Information Security Technologies, Korea University “A study on macro detection using information of touch events in Android mobile game environment”

\[4\] Joonun Jang, Huy Kang Kim “An Approach to Detect Macros via Self-similarity of Mobile Input”

\[5\] 정윤혁, 고려대학교 “A study of the android OS-based touch macro detection method”

\[6\] Development of Macro Program Detection System using Access_logJun-young Kim”O”, Kyu-rim Kim\*, Han-sol Park\*, Seung-hwan An\*, Hyun-tak Lee\*\*,Sang-Yong Choi\*, Jong-Rak Lee\* ”O”Department of Cyber Security, Yeungnam University College,\*Department of Cyber Security, Yeungnam University College,\*\*SeeYaInsignt

\[7\] Yong Goo Kang | Huy Kang Kim “Quick and easy game bot detection based on action time interval estimation”

\[8\] Taebok Yoon and Jee-Hyong Lee School of ICE, Sungkyunkwan University “A Study of Player Changed-pattern Model for Game Bots Detection in MMORPG”

\[9\] Jong-Woo Han\* , Seok-Yeon Kim\* , Se-Jong Lee\* , Ye-Gwang Lee\* , Chang-Jin Seo\* Sangmyung University, Department Of Information Security Engineering\* ”The Development of a Game Bot Detection System using Logs Data with the Property in Online Game using Machine Learning”

\[10\] Jun-Young Choi⋅Chang-Jin Seo, Cumulative Log based Online Game Bot Detection System using Machine Learning Model

\[11\] Myeongseong Ha O,1·Changyeon Kim2 ·Hyeongjun Cho2 ·Hyemin Cho3 , Yong Lee3 , Kwangyong Lee3 , How to detect gold farming groups by game macro and analysis of group behavior for game sources in an online game

\[12\] Detecting Daily-Driven Game-Bot Based on Online Game Play Log Clustering Joo Hwan Kim,1† Jin-Young Choi2† 1,2Graduate School of Information Security, Korea University (Graduate student,Professor)

\[13\] K-means: A Complete Introduction <https://towardsdatascience.com/k-means-a-complete-introduction-1702af9cd8c>

\[14\] 노코드머신러닝, 밀도를 기반으로 비슷한 것끼리 묶는다고요? <https://ablearn.kr/newsletter/?idx=13581593&bmode=view>
